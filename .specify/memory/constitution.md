<!--
  Sync Impact Report
  ==================
  Version Change: INITIAL → 1.0.0
  Modified Principles: N/A (Initial creation)
  Added Sections:
    - Core Principles (4 principles)
    - Performance Standards
    - Development Workflow
    - Governance
  Removed Sections: N/A
  
  Templates Status:
    ✅ .specify/templates/plan-template.md - Compatible (Constitution Check section will reference these principles)
    ✅ .specify/templates/spec-template.md - Compatible (User stories align with UX consistency principle)
    ✅ .specify/templates/tasks-template.md - Compatible (Test-first approach supported)
  
  Follow-up TODOs: None
-->

# News Website 项目宪章

## 核心原则

### I. 代码质量（非协商）

**核心规则**：
- 所有代码必须遵循统一的编码规范和风格指南
- 代码审查（Code Review）是强制性的，任何代码合并前必须至少一人审查批准
- 代码复杂度必须保持可控：函数不超过50行，圈复杂度不超过10
- 必须使用静态代码分析工具（linter）并通过所有检查
- 禁止提交包含 TODO、FIXME 或 HACK 注释的代码到主分支
- 所有公共 API 和关键函数必须有完整的文档注释
- 代码重复率不得超过3%（DRY 原则）

**理由**：高质量的代码是项目长期可维护性的基础。统一的代码标准确保团队协作效率，降低技术债务，减少缺陷率。

### II. 测试标准（非协商）

**核心规则**：
- 测试优先（Test-First）开发：编写测试 → 用户批准 → 测试失败 → 实现功能
- 严格执行 Red-Green-Refactor 循环
- 代码覆盖率要求：
  - 单元测试覆盖率必须 ≥ 80%
  - 关键业务逻辑覆盖率必须 = 100%
  - 集成测试必须覆盖所有用户故事
- 必须包含的测试类型：
  - 单元测试（Unit Tests）：测试独立模块
  - 集成测试（Integration Tests）：测试模块间交互
  - 端到端测试（E2E Tests）：测试完整用户流程
- 所有测试必须在 CI/CD 流程中自动运行
- 测试失败时禁止合并代码

**理由**：全面的测试体系是软件质量的保障。测试优先方法确保需求被正确理解和实现，防止回归缺陷，提高重构信心。

### III. 用户体验一致性

**核心规则**：
- 所有用户界面必须遵循统一的设计系统和组件库
- 响应式设计是强制性的，必须支持：
  - 移动端（320px - 767px）
  - 平板端（768px - 1023px）
  - 桌面端（≥ 1024px）
- 可访问性（Accessibility）要求：
  - 必须符合 WCAG 2.1 AA 级标准
  - 所有交互元素必须支持键盘导航
  - 必须提供适当的 ARIA 标签
- 交互反馈标准：
  - 用户操作必须在 100ms 内提供视觉反馈
  - 加载状态必须有清晰的进度指示
  - 错误信息必须明确且提供解决方案
- 多语言支持：所有用户可见文本必须支持国际化（i18n）

**理由**：一致的用户体验提高用户满意度和产品专业度。可访问性确保所有用户都能使用产品。响应式设计满足多设备使用场景。

### IV. 性能要求

**核心规则**：
- 页面加载性能指标（必须达标）：
  - 首次内容绘制（FCP）< 1.5 秒
  - 最大内容绘制（LCP）< 2.5 秒
  - 首次输入延迟（FID）< 100 毫秒
  - 累积布局偏移（CLS）< 0.1
- API 响应时间要求：
  - P95 响应时间 < 200ms
  - P99 响应时间 < 500ms
- 资源优化要求：
  - 图片必须使用现代格式（WebP、AVIF）并进行压缩
  - JavaScript 包大小必须 < 200KB（gzip 后）
  - CSS 包大小必须 < 50KB（gzip 后）
  - 必须实现代码分割（Code Splitting）和懒加载
- 性能监控：
  - 必须集成性能监控工具（如 Lighthouse CI）
  - 每次部署前必须运行性能审计
  - 性能回归必须在 PR 中标记并说明

**理由**：性能直接影响用户体验和业务指标。快速的加载和响应提高用户留存率，优化的资源使用降低运营成本。

## 性能标准

### 监控与度量
- 必须在生产环境实施实时性能监控
- 必须设置性能预警阈值和告警机制
- 必须定期（至少每周）审查性能报告
- 性能问题必须在发现后 24 小时内分类并分配优先级

### 性能测试要求
- 负载测试：必须模拟预期用户量的 150% 进行压力测试
- 压力测试：必须测试系统极限和降级方案
- 性能基准：每个版本必须建立性能基线并与之前版本对比

## 开发工作流

### 分支策略
- 主分支（main）：仅包含生产就绪代码
- 功能分支（feature/###-feature-name）：遵循规范命名
- 所有功能必须从 main 分支创建新分支
- 禁止直接提交到 main 分支

### 代码审查流程
1. 创建 Pull Request 并完整填写描述模板
2. 自动运行 CI 检查（linting、测试、性能审计）
3. 至少一名团队成员完成代码审查
4. 所有审查意见必须解决
5. 通过所有自动化检查后方可合并

### 质量门禁
每个 Pull Request 必须通过以下检查：
- ✅ 所有自动化测试通过
- ✅ 代码覆盖率达标
- ✅ 静态代码分析无错误
- ✅ 性能指标未退化
- ✅ 可访问性审计通过
- ✅ 至少一次代码审查批准

### 文档要求
- 所有新功能必须更新相关文档
- API 变更必须更新 API 文档
- 重大变更必须更新 CHANGELOG
- 复杂逻辑必须有架构决策记录（ADR）

## 治理

### 宪章权威性
本宪章优先于所有其他开发实践和流程文档。任何与本宪章冲突的做法均视为违规。

### 合规性审查
- 所有 Pull Request 必须经过宪章合规性验证
- 项目负责人每月进行一次全面合规性审查
- 违规行为必须记录并在下次团队会议中讨论

### 修订流程
修订本宪章需要：
1. 提出修订提案，说明原因和影响范围
2. 团队讨论和投票（需 2/3 多数通过）
3. 编写迁移计划（如适用）
4. 更新版本号并记录修订历史
5. 同步更新所有依赖模板和文档

### 复杂度豁免
如需违反宪章原则（例如性能优化需要增加复杂度），必须：
- 在实施计划中的"复杂度跟踪"表格中记录
- 说明为何需要违规
- 说明为何更简单的替代方案不可行
- 获得项目负责人批准

### 运行时开发指导
开发过程中如有疑问，参考：
- 特性规范模板：`.specify/templates/spec-template.md`
- 实施计划模板：`.specify/templates/plan-template.md`
- 任务分解模板：`.specify/templates/tasks-template.md`

**版本**: 1.0.0 | **批准日期**: 2025-10-10 | **最后修订**: 2025-10-10
